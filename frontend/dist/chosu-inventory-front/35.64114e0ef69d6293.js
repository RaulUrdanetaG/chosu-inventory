"use strict";(self.webpackChunkchosu_inventory_front=self.webpackChunkchosu_inventory_front||[]).push([[35],{1035:(J,u,s)=>{s.r(u),s.d(u,{NewItemModule:()=>S});var c=s(6814),m=s(2526),p=s(5861),a=s(95),e=s(4946),d=s(5634),f=s(6125),v=s(2381),_=s(5434);function w(t,o){1&t&&(e.TgZ(0,"div",34),e.O4$(),e.TgZ(1,"svg",35),e._UZ(2,"path",36),e.qZA()())}function T(t,o){if(1&t&&e._UZ(0,"img",37),2&t){const r=e.oxw();e.Q6J("src",r.imageSrc,e.LSH)}}function h(t,o){1&t&&(e.TgZ(0,"label",38),e._uU(1," Subir imagen "),e._UZ(2,"i",39),e.qZA())}function Z(t,o){1&t&&(e.TgZ(0,"label",38),e._uU(1," Cambiar imagen "),e._UZ(2,"i",39),e.qZA())}function N(t,o){if(1&t&&(e.TgZ(0,"option",40),e._uU(1),e.qZA()),2&t){const r=o.$implicit;e.s9C("value",r.tagname),e.xp6(1),e.hij(" ",r.tagname," ")}}function x(t,o){if(1&t){const r=e.EpF();e.TgZ(0,"div")(1,"div",43),e._uU(2),e.TgZ(3,"a",44),e.NdJ("click",function(){const l=e.CHM(r).$implicit,g=e.oxw(2);return e.KtG(g.onTagDelete(l))}),e._UZ(4,"i",45),e.qZA()()()}if(2&t){const r=o.$implicit;e.xp6(2),e.hij(" ",r," ")}}function b(t,o){if(1&t&&(e.TgZ(0,"div",41),e.YNc(1,x,5,1,"div",42),e.qZA()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngForOf",r.currentTags)}}function I(t,o){if(1&t&&(e.TgZ(0,"option",40),e._uU(1),e.qZA()),2&t){const r=o.$implicit;e.s9C("value",r.owner),e.xp6(1),e.hij(" ",r.owner," ")}}function C(t,o){if(1&t&&(e.TgZ(0,"option",40),e._uU(1),e.qZA()),2&t){const r=o.$implicit;e.s9C("value",r.location),e.xp6(1),e.hij(" ",r.location," ")}}function q(t,o){1&t&&(e.TgZ(0,"p",46),e._uU(1," Por favor rellene todos los campos "),e.qZA())}function U(t,o){1&t&&(e.TgZ(0,"p",46),e._uU(1," Error al subir, intente de nuevo. "),e.qZA())}const y=function(t){return{uploading:t}},A=[{path:"",component:(()=>{var t;class o{constructor(n,i,l,g){this.itemsService=n,this.tagsService=i,this.ownersService=l,this.locationsService=g,this.selectedFile=null,this.currentTags=[],this.tags=[],this.provTags=[],this.owners=[],this.locations=[],this.imageSrc=null,this.isValid=!0,this.isUploading=!1,this.isUploaded=!0,this.itemForm=new a.cw({name:new a.NI,imagelink:new a.NI,price:new a.NI,boughtAt:new a.NI,location:new a.NI,tags:new a.NI,owner:new a.NI})}ngOnInit(){var n=this;return(0,p.Z)(function*(){n.tagsService.setTags(),n.ownersService.setOwners(),n.tagsService.tags$.subscribe(i=>{n.tags=n.provTags=i.filter(l=>!n.currentTags.includes(l.tagname))}),n.ownersService.owners$.subscribe(i=>{n.owners=i}),n.locations=yield n.locationsService.getLocations()})()}onSubmit(){var n=this;return(0,p.Z)(function*(){if(n.itemForm.valid){if(n.isValid=!0,n.isUploading=!0,n.itemForm.get("tags")?.setValue(n.currentTags),null!==n.selectedFile){const l=new FormData;l.append("image",n.selectedFile);const g=yield n.itemsService.addItemImage(l);n.itemForm.get("imagelink")?.setValue(g.url)}else n.itemForm.get("imagelink")?.setValue("");if((yield n.itemsService.addItem(n.itemForm.value)).error)return void(n.isUploaded=!1);n.itemForm.reset(),n.imageSrc=null,n.currentTags=[],n.tags=n.provTags,n.isUploading=!1}else n.isValid=!1})()}onTagSelect(n){this.currentTags.push(n.value),this.tags=this.provTags.filter(i=>!this.currentTags.includes(i.tagname))}onTagDelete(n){this.currentTags=this.currentTags.filter(i=>i!==n),this.tags=this.provTags.filter(i=>!this.currentTags.includes(i.tagname))}onFileSelected(n){const i=n.target.files[0];if(this.selectedFile=i,i){const l=new FileReader;l.onload=g=>{this.imageSrc=g.target.result},l.readAsDataURL(i)}}}return(t=o).\u0275fac=function(n){return new(n||t)(e.Y36(d.L),e.Y36(f.i),e.Y36(v.C),e.Y36(_.a))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-new-item"]],decls:57,vars:14,consts:[[1,"flex","flex-col","items-center","justify-center","min-h-full","bg-slate-50","relative"],["class","absolute loading-svg",4,"ngIf"],["routerLink","/items/all",1,"absolute","left-3","top-2"],[1,"fa-solid","fa-arrow-left"],[1,"new-item-card","p-3","bg-white","rounded-lg","shadow-2xl","flex","flex-col","gap-2",3,"ngClass"],[1,"flex","flex-col","justify-center","gap-1","new-img-container"],[1,"flex","justify-center"],["alt","Imagen Cargada","class","new-img rounded-lg",3,"src",4,"ngIf"],["for","img-input","class","bg-burnt-siena rounded-lg px-2 self-center hover:cursor-pointer hover:bg-opacity-80",4,"ngIf"],["type","file","id","img-input","accept","image/*","required","",1,"img-input",3,"change"],[1,"flex","flex-col","gap-2",3,"formGroup"],["type","hidden","formControlName","imagelink"],[1,"flex","justify-between","gap-1"],["for","name"],["type","text","formControlName","name","id","name","required","",1,"bg-gray-100","rounded-md","px-2","flex-1"],[1,"flex","gap-2"],[1,"flex","flex-col","gap-2"],["for","price"],["for","boughtAt"],[1,"flex","flex-col","flex-1","gap-2","justify-around"],[1,"flex"],["type","number","formControlName","price","id","price","min","0","required","",1,"bg-gray-100","rounded-md","px-2","flex-1"],["type","number","formControlName","boughtAt","id","boughtAt","min","0","required","",1,"bg-gray-100","rounded-md","px-2","flex-1"],[1,"flex","gap-2","items-center","justify-between"],["for","tags"],["id","tags","formControlName","tags","required","",1,"bg-gray-100","rounded-md",3,"change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","px-2","bg-green-300","rounded-lg","items-center","justify-center","hover:bg-opacity-80",3,"click"],["class","flex gap-1 mb-3 flex-wrap",4,"ngIf"],["id","owner","formControlName","owner","required","",1,"bg-gray-100","rounded-md"],["for","location"],["id","location","formControlName","location","required","",1,"bg-gray-100","rounded-md","flex-1"],["class","text-red-600",4,"ngIf"],[1,"flex","px-2","bg-blue-300","rounded-lg","items-center","justify-center","hover:bg-opacity-80",3,"click"],[1,"absolute","loading-svg"],["xmlns","http://www.w3.org/2000/svg","height","48","viewBox","0 -960 960 960","width","48",1,"animate-spin"],["d","M480-80q-84 0-157-31t-127-85q-54-54-85-127T80-480q0-84 31-157t85-127q54-54 127-85t157-31q12 0 21 9t9 21q0 12-9 21t-21 9q-141 0-240.5 99.5T140-480q0 141 99.5 240.5T480-140q141 0 240.5-99.5T820-480q0-12 9-21t21-9q12 0 21 9t9 21q0 84-31 157t-85 127q-54 54-127 85T480-80Z",1,"fill-slate-500"],["alt","Imagen Cargada",1,"new-img","rounded-lg",3,"src"],["for","img-input",1,"bg-burnt-siena","rounded-lg","px-2","self-center","hover:cursor-pointer","hover:bg-opacity-80"],[1,"fa-regular","fa-image"],[3,"value"],[1,"flex","gap-1","mb-3","flex-wrap"],[4,"ngFor","ngForOf"],[1,"flex","gap-1","items-center","p-1","rounded-lg","bg-slate-200","hover:cursor-default"],[3,"click"],[1,"fa-solid","fa-circle-xmark","text-slate-400","hover:cursor-pointer"],[1,"text-red-600"]],template:function(n,i){1&n&&(e.TgZ(0,"section",0),e.YNc(1,w,3,0,"div",1),e.TgZ(2,"button",2),e._UZ(3,"i",3),e._uU(4," Volver "),e.qZA(),e.TgZ(5,"div",4)(6,"form",5)(7,"div",6),e.YNc(8,T,1,1,"img",7),e.qZA(),e.YNc(9,h,3,0,"label",8),e.YNc(10,Z,3,0,"label",8),e.TgZ(11,"input",9),e.NdJ("change",function(g){return i.onFileSelected(g)}),e.qZA()(),e.TgZ(12,"form",10),e._UZ(13,"input",11),e.TgZ(14,"div",12)(15,"label",13),e._uU(16,"Nombre: "),e.qZA(),e._UZ(17,"input",14),e.qZA(),e.TgZ(18,"div",15)(19,"div",16)(20,"label",17),e._uU(21,"Precio: "),e.qZA(),e.TgZ(22,"label",18),e._uU(23,"Comprado en: "),e.qZA()(),e.TgZ(24,"div",19)(25,"div",20)(26,"p"),e._uU(27,"$"),e.qZA(),e._UZ(28,"input",21),e.qZA(),e.TgZ(29,"div",20)(30,"p"),e._uU(31,"$"),e.qZA(),e._UZ(32,"input",22),e.qZA()()(),e.TgZ(33,"div",23)(34,"label",24),e._uU(35,"Etiquetas: "),e.qZA(),e.TgZ(36,"select",25),e.NdJ("change",function(g){return i.onTagSelect(g.target)}),e.YNc(37,N,2,2,"option",26),e.qZA(),e.TgZ(38,"button",27),e.NdJ("click",function(){return i.tagsService.isNewTagModal=!0}),e._uU(39," Nueva etiqueta "),e.qZA()(),e.YNc(40,b,2,1,"div",28),e.TgZ(41,"div",23)(42,"label",24),e._uU(43,"Due\xf1o: "),e.qZA(),e.TgZ(44,"select",29),e.YNc(45,I,2,2,"option",26),e.qZA(),e.TgZ(46,"button",27),e.NdJ("click",function(){return i.ownersService.isNewOwnerModal=!0}),e._uU(47," Nuevo due\xf1o "),e.qZA()(),e.TgZ(48,"div",12)(49,"label",30),e._uU(50,"Ubicaci\xf3n del articulo: "),e.qZA(),e.TgZ(51,"select",31),e.YNc(52,C,2,2,"option",26),e.qZA()(),e.YNc(53,q,2,0,"p",32),e.YNc(54,U,2,0,"p",32),e.TgZ(55,"button",33),e.NdJ("click",function(){return i.onSubmit()}),e._uU(56," A\xf1adir producto "),e.qZA()()()()),2&n&&(e.xp6(1),e.Q6J("ngIf",i.isUploading),e.xp6(4),e.Q6J("ngClass",e.VKq(12,y,i.isUploading)),e.xp6(3),e.Q6J("ngIf",i.imageSrc),e.xp6(1),e.Q6J("ngIf",!i.imageSrc),e.xp6(1),e.Q6J("ngIf",i.imageSrc),e.xp6(2),e.Q6J("formGroup",i.itemForm),e.xp6(25),e.Q6J("ngForOf",i.tags),e.xp6(3),e.Q6J("ngIf",i.currentTags.length>0),e.xp6(5),e.Q6J("ngForOf",i.owners),e.xp6(7),e.Q6J("ngForOf",i.locations),e.xp6(1),e.Q6J("ngIf",!i.isValid),e.xp6(1),e.Q6J("ngIf",!i.isUploaded))},dependencies:[c.mk,c.sg,c.O5,m.rH,a._Y,a.YN,a.Kr,a.Fj,a.wV,a.EJ,a.JJ,a.JL,a.Q7,a.qQ,a.sg,a.u],styles:[".new-item-card[_ngcontent-%COMP%]{max-width:400px;margin-top:20px}.new-img[_ngcontent-%COMP%]{width:200px;height:300px}.img-input[_ngcontent-%COMP%]{display:none}.loading-svg[_ngcontent-%COMP%]{top:50%;left:50%;transform:translate(-50%,-50%)}.uploading[_ngcontent-%COMP%]{opacity:.1}"]}),o})()}];let F=(()=>{var t;class o{}return(t=o).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[m.Bz.forChild(A),m.Bz]}),o})(),S=(()=>{var t;class o{}return(t=o).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[c.ez,F,a.UX]}),o})()}}]);